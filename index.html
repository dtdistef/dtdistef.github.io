<!DOCTYPE html>
<html>
<head>
    <style>
        .button
        {
            border: none;
            color: white;
            width: 400px;
            height: 100px;
            text-align: center;
            text-decoration: none;
            display: block;
            font-size: 16px;
            margin: 4px 2px;
            cursor: pointer;
        }
        .buttonTest{background-color: coral;}
    </style>
</head>
<body>

<h2 id='head'>Decks</h2>
<p id='buttons'></p>

<script>
    //Test fetching the json file from github server
    async function GetJson(){
        let fetch_response = await fetch("./listOfDecks.json");
        let data = await fetch_response.json();

        DisplayDecks(data)
    }

    async function GetCategories(file_name){
        let fetch_response = await fetch(file_name);
        let data = await fetch_response.json();

        DisplayCategories(data)
    }

    function DisplayDecks(jsonOfDecks){
        document.getElementById("head").textContent = "Decks";
        document.getElementById("buttons").innerHTML = '';
        var decks = jsonOfDecks.decks;
        var numOfDecks = decks.length;

        for (i = 0; i < numOfDecks; i++){
            var element = document.createElement("button");
            element.setAttribute("class", "button buttonTest");
            element.style.backgroundColor = decks[i]["color"];
            element.textContent = decks[i]["name"];

            element.onclick = (function(i){return function (){
                GetCategories(decks[i].categories_file)
            }; })(i);

            document.getElementById("buttons").appendChild(element);
        }
    }
    
    function DisplayCategories(jsonCategories){
        document.getElementById("head").textContent = "Categories";
        document.getElementById("buttons").innerHTML = '';
        var categories = jsonCategories.categories;
        var numOfCategories = categories.length;
        for (i = 0; i < numOfCategories; i++){
            console.log(i)
            var element = document.createElement("button");
            element.setAttribute("class", "button buttonTest");
            element.style.backgroundColor = categories[i]["color"];
            element.textContent = categories[i]["name"];

            //element.onclick = (function(i){return function (){
            //    DisplayCategories(i)
            //}; })(i);

            document.getElementById("buttons").appendChild(element)
        }

        var element = document.createElement("button");
        element.setAttribute("class", "button buttonTest");
        element.style.backgroundColor = "black"
        element.textContent = "Back";

        element.onclick = (function(i){return function (){
            GetJson()
        }; })(i);
        
        document.getElementById("buttons").appendChild(element)
    }

    GetJson();
</script>
</body>
</html>